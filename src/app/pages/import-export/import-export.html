<div class="container">
  <h1 class="title">Import / Export des donnÃ©es</h1>

  <!-- Current Data Stats -->
  <div class="stats-row">
    <div class="stat-box">
      <div class="stat-number">{{ getCurrentHarvestCount() }}</div>
      <div class="stat-label">RÃ©coltes enregistrÃ©es</div>
    </div>
    <div class="stat-box">
      <div class="stat-number">{{ getCurrentVegetableCount() }}</div>
      <div class="stat-label">LÃ©gumes diffÃ©rents</div>
    </div>
  </div>

  <!-- Export Section -->
  <div class="section-card">
    <div class="section-header">
      <h2 class="section-title">ğŸ“¤ Exporter les donnÃ©es</h2>
      <p class="section-description">
        TÃ©lÃ©chargez toutes vos rÃ©coltes dans un fichier Excel (.xlsx)
      </p>
    </div>

    <div class="section-content">
      <button (click)="exportCurrentData()" class="btn btn-primary btn-large">
        <span class="btn-icon">ğŸ“¥</span>
        Exporter mes rÃ©coltes en Excel
      </button>

      <div *ngIf="exportStatus !== 'idle'" class="alert" [class.alert-success]="exportStatus === 'success'" [class.alert-error]="exportStatus === 'error'">
        {{ exportMessage }}
      </div>
    </div>
  </div>

  <!-- Import Section -->
  <div class="section-card">
    <div class="section-header">
      <h2 class="section-title">ğŸ“¥ Importer des donnÃ©es</h2>
      <p class="section-description">
        Chargez un fichier Excel contenant vos rÃ©coltes. Le fichier doit contenir les colonnes : LÃ©gume, QuantitÃ©, UnitÃ©, Date, Notes
      </p>
    </div>

    <div class="section-content">
      <div class="file-input-wrapper">
        <input
          type="file"
          id="file-input"
          accept=".xlsx,.xls"
          (change)="onFileSelected($event)"
          class="file-input"
        />
        <label for="file-input" class="btn btn-secondary btn-large">
          <span class="btn-icon">ğŸ“</span>
          Choisir un fichier Excel
        </label>
      </div>

      <div *ngIf="importStatus !== 'idle'" class="alert" [class.alert-success]="importStatus === 'success'" [class.alert-error]="importStatus === 'error'">
        {{ importMessage }}
      </div>
    </div>
  </div>

  <!-- Sample Data Section -->
  <div class="section-card section-card-highlight">
    <div class="section-header">
      <h2 class="section-title">ğŸ² DonnÃ©es factices</h2>
      <p class="section-description">
        GÃ©nÃ©rez des donnÃ©es d'exemple pour tester l'application
      </p>
    </div>

    <div class="section-content">
      <div class="button-group">
        <button (click)="downloadSampleData()" class="btn btn-outline">
          <span class="btn-icon">ğŸ“„</span>
          TÃ©lÃ©charger un fichier exemple
        </button>

        <button (click)="loadSampleData()" class="btn btn-accent">
          <span class="btn-icon">âœ¨</span>
          Charger 150 rÃ©coltes factices
        </button>
      </div>

      <div *ngIf="sampleDataStatus !== 'idle'" class="alert" [class.alert-success]="sampleDataStatus === 'success'" [class.alert-error]="sampleDataStatus === 'error'">
        {{ sampleDataMessage }}
      </div>

      <div class="info-box">
        <strong>ğŸ’¡ Astuce :</strong> Les donnÃ©es factices incluent 10 lÃ©gumes diffÃ©rents avec 150 rÃ©coltes rÃ©parties sur l'annÃ©e 2024, parfait pour tester les statistiques !
      </div>
    </div>
  </div>

  <!-- Danger Zone -->
  <div class="section-card section-card-danger">
    <div class="section-header">
      <h2 class="section-title">âš ï¸ Zone de danger</h2>
      <p class="section-description">
        Action irrÃ©versible : supprime toutes les donnÃ©es
      </p>
    </div>

    <div class="section-content">
      <button (click)="clearAllData()" class="btn btn-danger btn-large">
        <span class="btn-icon">ğŸ—‘ï¸</span>
        Supprimer toutes les donnÃ©es
      </button>
    </div>
  </div>

  <!-- Help Section -->
  <div class="help-section">
    <h3 class="help-title">ğŸ“– Format du fichier Excel</h3>
    <div class="help-content">
      <p>Votre fichier Excel doit contenir les colonnes suivantes :</p>
      <ul class="help-list">
        <li><strong>LÃ©gume</strong> : Nom du lÃ©gume (obligatoire)</li>
        <li><strong>QuantitÃ©</strong> : Nombre ou poids rÃ©coltÃ© (obligatoire)</li>
        <li><strong>UnitÃ©</strong> : g, kg ou pcs (obligatoire)</li>
        <li><strong>Date</strong> : Date de la rÃ©colte au format JJ/MM/AAAA (obligatoire)</li>
        <li><strong>Notes</strong> : Remarques sur la rÃ©colte (facultatif)</li>
      </ul>
      <p class="help-note">
        <strong>Exemple :</strong> TÃ©lÃ©chargez le fichier exemple pour voir le format attendu.
      </p>
    </div>
  </div>
</div>
